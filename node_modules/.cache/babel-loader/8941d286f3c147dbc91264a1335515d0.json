{"ast":null,"code":"var _jsxFileName = \"/Users/calvinyung/Desktop/Fall 2020/cs130/project/cs130/src/pages/Login.tsx\";\nimport React from 'react';\nimport { IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonButton, IonInput } from '@ionic/react';\nimport { useForm } from \"react-hook-form\";\nimport { useHistory } from 'react-router-dom';\nimport firebase from '../Firebase';\nimport { Plugins, Geolocation } from '@capacitor/core';\nconst {\n  App\n} = Plugins;\n\nasync function getPosition() {\n  const coordinates = await Geolocation.getCurrentPosition();\n  console.log(\"Current position\", coordinates);\n  return coordinates['coords'];\n}\n\nconst Login = () => {\n  const history = useHistory();\n  const {\n    register,\n    handleSubmit\n  } = useForm();\n\n  const goBack = () => {\n    history.push('/OnOpen');\n  };\n\n  const onSubmit = data => {\n    firebase.auth().signInWithEmailAndPassword(data.e, data.p).then(user => {\n      console.log(user);\n      App.addListener('appStateChange', state => {\n        if (state.isActive) {\n          const usr_loc = getPosition();\n          const db = firebase.firestore().collection('users'); //const user = firebase.auth().currentUser;\n\n          var user_id = '';\n\n          if (user != null) {\n            user_id = user.uid.toString();\n          }\n\n          db.doc(user_id).update({\n            'location': usr_loc\n          });\n          console.log(\"Pushed location\\n\");\n        }\n      });\n    }).then(() => {\n      history.push('/Tab1');\n    }).catch(error => console.log(error));\n  };\n\n  return /*#__PURE__*/React.createElement(IonPage, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(IonHeader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(IonToolbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(IonTitle, {\n    size: \"large\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 11\n    }\n  }, \"Login\"))), /*#__PURE__*/React.createElement(IonContent, {\n    className: \"page\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit(onSubmit),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }\n  }, \"Email:\"), /*#__PURE__*/React.createElement(IonInput, {\n    required: true,\n    type: \"email\",\n    id: \"e\",\n    name: \"e\",\n    ref: register,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }, \"Password:\"), /*#__PURE__*/React.createElement(IonInput, {\n    required: true,\n    type: \"password\",\n    id: \"p\",\n    name: \"p\",\n    ref: register,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(IonButton, {\n    \"justify-content\": \"center\",\n    color: \"black\",\n    size: \"large\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }\n  }, \"Sign In\"), /*#__PURE__*/React.createElement(IonButton, {\n    color: \"black\",\n    size: \"large\",\n    onClick: goBack,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }, \"Back\"))));\n};\n\nexport default Login;","map":{"version":3,"sources":["/Users/calvinyung/Desktop/Fall 2020/cs130/project/cs130/src/pages/Login.tsx"],"names":["React","IonContent","IonHeader","IonPage","IonTitle","IonToolbar","IonButton","IonInput","useForm","useHistory","firebase","Plugins","Geolocation","App","getPosition","coordinates","getCurrentPosition","console","log","Login","history","register","handleSubmit","goBack","push","onSubmit","data","auth","signInWithEmailAndPassword","e","p","then","user","addListener","state","isActive","usr_loc","db","firestore","collection","user_id","uid","toString","doc","update","catch","error"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { IonContent, \n  IonHeader, \n  IonPage, \n  IonTitle, \n  IonToolbar, \n  IonButton, \n  IonInput,\n  useIonViewWillEnter } from '@ionic/react';\nimport ExploreContainer from '../components/ExploreContainer';\nimport { useForm } from \"react-hook-form\"\nimport {useHistory} from 'react-router-dom'\nimport firebase from '../Firebase'\nimport { Plugins, AppState, Geolocation } from '@capacitor/core';\nconst { App } = Plugins;\n\n\ntype SignIn = {\n  e: string;\n  p: string;\n}\n\nasync function getPosition() {\n  const coordinates = await Geolocation.getCurrentPosition();\n  console.log(\"Current position\", coordinates);\n  return coordinates['coords'];\n}\n\nconst Login: React.FC = () => {\n  const history = useHistory()\n  const {register, handleSubmit} = useForm<SignIn>();\n  const goBack = () => {\n    history.push('/OnOpen')\n  }\n\n  const onSubmit = (data: SignIn) => {\n    firebase.auth().signInWithEmailAndPassword(data.e, data.p)\n    .then((user:any)=>{\n      console.log(user)\n      App.addListener('appStateChange', (state:AppState) => {\n        if(state.isActive){\n          const usr_loc = getPosition();\n          const db = firebase.firestore().collection('users');\n          //const user = firebase.auth().currentUser;\n          var user_id = '';\n          if (user!=null){\n            user_id = user.uid.toString();\n          }\n          db.doc(user_id).update({'location': usr_loc});\n          console.log(\"Pushed location\\n\");\n        }\n      });\n    }).then(()=>{\n      history.push('/Tab1')\n    })\n    .catch((error) => console.log(error))\n  };\n\n  return (\n    <IonPage>\n    <IonHeader>\n    <IonToolbar>\n          <IonTitle size=\"large\">Login</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent className=\"page\">\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <label>Email:</label>\n          <IonInput\n          required={true}\n          type=\"email\"\n          id=\"e\"\n          name=\"e\"\n          ref={register}\n          />\n        <label>Password:</label>\n          <IonInput\n          required={true}\n          type=\"password\"\n          id=\"p\"\n          name=\"p\"\n          ref={register}\n          />\n        <IonButton justify-content='center' color=\"black\" size='large' type=\"submit\">Sign In</IonButton>\n        <IonButton color=\"black\" size='large' onClick={goBack}>Back</IonButton>\n        </form>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}