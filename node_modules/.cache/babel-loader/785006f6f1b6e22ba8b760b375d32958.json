{"ast":null,"code":"var _jsxFileName = \"/Users/zhirongwang/Desktop/cs130/src/pages/Tab1.js\";\nimport React, { Component, useState } from 'react';\nimport GoogleMapReact from 'google-map-react';\nimport './map.css'; // for the map, className=\"google-map\"\n\nimport { Icon } from '@iconify/react'; // for map pin\n\nimport locationIcon from '@iconify/icons-mdi/map-marker'; // for map pin\n\nimport PlaceCard from '../components/PlaceCard';\nimport Marker from './Marker';\nimport SimpleMarker from './SimpleMarker'; //import { Geolocation, Geoposition } from '@ionic-native/geolocation';\n\nimport { Button, Input, Divider, message } from 'antd';\nimport { AnyCnameRecord } from 'dns';\nimport { IonHeader, IonToolbar, IonTitle, IonContent, IonList, IonItem, IonLabel, IonInput, IonButton, IonPage } from \"@ionic/react\";\n\nclass Tab1 extends Component {\n  constructor(props) {\n    super(props);\n\n    this.apiHasLoaded = (map, mapsApi) => {\n      this.setState({\n        mapsLoaded: true,\n        map: map,\n        mapsApi: mapsApi,\n        placesService: new mapsApi.places.PlacesService(map),\n        geoCoderService: new mapsApi.Geocoder(),\n        directionService: new mapsApi.DirectionsService()\n      });\n    };\n\n    this.handleSearch = () => {\n      if (this.state.map === {}) {\n        return;\n      }\n\n      console.log(this.state.mapsApi);\n      console.log(this.state.map);\n      console.log(this.state.placesService);\n      console.log(this.state.latitude, this.state.longitude);\n      let {\n        markers,\n        placesService,\n        directionService,\n        mapsApi\n      } = this.state;\n      const filteredResults = []; //if (markers.length === 0){\n      //  console.log(\"add marker and try again\");\n      //  return;\n      //}\n\n      const markerLatLng = new mapsApi.LatLng(this.state.latitude, this.state.longitude);\n      const placesRequest = {\n        location: markerLatLng,\n        //radius: '3000000', // Cannot be used with rankBy. Pick your poison!\n        type: ['hospital', 'pharmacy', 'doctor'],\n        // List of types: https://developers.google.com/places/supported_types\n        query: 'covid 19 testing site',\n        rankBy: mapsApi.places.RankBy.DISTANCE\n      };\n      console.log(placesRequest);\n      placesService.textSearch(placesRequest, response => {\n        console.log(response.length);\n        let responseLimit = Math.min(5, response.length);\n\n        for (let i = 0; i < responseLimit; i++) {\n          const covidTesting = response[i];\n          const {\n            rating,\n            name\n          } = covidTesting;\n          const address = covidTesting.formatted_address;\n          const lat = covidTesting.geometry.location.lat();\n          const lng = covidTesting.geometry.location.lng();\n          let openNow = false;\n\n          if (covidTesting.opening_hours) {\n            openNow = covidTesting.opening_hours.isOpen(); // e.g true/false\n          } //console.log(name,address, openNow);\n\n\n          filteredResults.push({\n            name,\n            address,\n            rating,\n            lat,\n            lng,\n            openNow\n          });\n          this.setState({\n            searchResults: filteredResults\n          });\n        }\n\n        console.log(this.state.searchResults);\n\n        for (let i = 0; i < 5; i++) {\n          if (this.state.searchResults[i] != null) {\n            console.log(\"check inside\");\n            const site_lat = this.state.searchResults[i].lat;\n            const site_lng = this.state.searchResults[i].lng;\n            const temp_lats = this.state.testing_site_lats.concat(site_lat);\n            console.log(\"check temp:\", temp_lats);\n            this.setState({\n              testing_site_lngs: [1, 2]\n            });\n          }\n        }\n\n        console.log(\"checkkk  lat:\", this.state.testing_site_lats); //  for(let i=0; i<5; i++){\n        //    if (this.state.searchResults[i] != null){\n        //      const site_lat = this.state.searchResults[i].lat;\n        //      const site_lng = this.state.searchResults[i].lng;\n        //      console.log(\"checkkk \", i+1, \"th site: \", site_lat, site_lng );\n        //      const latlng = {\"lat\": site_lat, \"lng\": site_lng};\n        //      var temp_array = this.testing_site_latlng;\n        //      temp_array.push(latlng);\n        //      this.setState(testing_site_latlng: temp_array);\n        //    } \n        //  }\n        // const site_lat = this.state.searchResults[0] ?  this.state.searchResults[0].lat : 37.7313737;\n        // const site_lng = this.state.searchResults[0] ?  this.state.searchResults[0].lng : -122.4125537;\n        // console.log(\"hello trying\")\n        // console.log(\"lat and lng are: \", site_lat, site_lng); \n      });\n    };\n\n    this.state = {\n      mapsLoaded: false,\n      latitude: 38,\n      longitude: -118,\n      map: {},\n      mapsApi: {},\n      markers: [],\n      searchResults: [],\n      placesService: {},\n      geoCoderService: {},\n      directionService: {},\n      testing_site_lats: [],\n      // array of number\n      testing_site_lngs: []\n    };\n  }\n\n  async componentDidMount() {\n    await navigator.geolocation.getCurrentPosition(position => this.setState({\n      latitude: position.coords.latitude,\n      longitude: position.coords.longitude\n    }));\n  } //    handleClick = () => {\n  //        this.componentDidMount();\n  //        console.log(\"set longitude:\",this.state.longitude);\n  //      }\n  //<IonButton color=\"primary\" onClick={this.getLocation}>{this.state.longitude ? `${this.state.latitude} ${this.state.longitude}` : \"Get Location\"}</IonButton>\n\n\n  render() {\n    //const { constraints, mapsLoaded, singaporeLatLng, markers, searchResults } = this.state;\n    const {\n      markers,\n      geoCoderService,\n      searchResults\n    } = this.state; // Google Maps Services\n\n    return /*#__PURE__*/React.createElement(IonPage, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(IonContent, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 15\n      }\n    }, \"Current Location: \", JSON.stringify(this.state.latitude), \" ,  \", JSON.stringify(this.state.longitude)), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 15\n      }\n    }, \"Initial Location: \", JSON.stringify(this.state.latitude), \" ,  \", JSON.stringify(this.state.longitude)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"google-map\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(GoogleMapReact, {\n      bootstrapURLKeys: {\n        key: \"AIzaSyBj9b-EHxuAAihd8u2HBBqWOSXukFlA3jY\",\n        libraries: ['places', 'directions']\n      },\n      defaultZoom: 15,\n      defaultCenter: {\n        lat: 38,\n        lng: -118\n      },\n      center: {\n        lat: this.state.latitude,\n        lng: this.state.longitude\n      },\n      yesIWantToUseGoogleMapApiInternals: true,\n      yesIWantToUseGoogleMapApiInternals: true,\n      onGoogleApiLoaded: ({\n        map,\n        maps\n      }) => this.apiHasLoaded(map, maps) // \"maps\" is the mapApi. Bad naming but that's their library.\n      ,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Marker, {\n      lat: this.state.latitude,\n      lng: this.state.longitude,\n      name: \"My Marker\",\n      color: \"blue\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 14\n      }\n    }), /*#__PURE__*/React.createElement(SimpleMarker, {\n      lat: this.state.latitude,\n      lng: this.state.longitude,\n      name: \"My Marker\",\n      color: \"blue\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 14\n      }\n    }))), /*#__PURE__*/React.createElement(IonButton, {\n      color: \"primary\",\n      onClick: this.handleSearch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 15\n      }\n    }, \" \", \"search\", \"  \"), searchResults.length > 0 ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"section\", {\n      className: \"col-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex flex-column justify-content-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"mb-4 fw-md\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 15\n      }\n    }, \"Testing Center Nearby\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex flex-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 18\n      }\n    }, searchResults.map((result, key) => /*#__PURE__*/React.createElement(PlaceCard, {\n      info: result,\n      key: key,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 58\n      }\n    })))))) : null));\n  }\n\n}\n\n;\nexport default Tab1;","map":{"version":3,"sources":["/Users/zhirongwang/Desktop/cs130/src/pages/Tab1.js"],"names":["React","Component","useState","GoogleMapReact","Icon","locationIcon","PlaceCard","Marker","SimpleMarker","Button","Input","Divider","message","AnyCnameRecord","IonHeader","IonToolbar","IonTitle","IonContent","IonList","IonItem","IonLabel","IonInput","IonButton","IonPage","Tab1","constructor","props","apiHasLoaded","map","mapsApi","setState","mapsLoaded","placesService","places","PlacesService","geoCoderService","Geocoder","directionService","DirectionsService","handleSearch","state","console","log","latitude","longitude","markers","filteredResults","markerLatLng","LatLng","placesRequest","location","type","query","rankBy","RankBy","DISTANCE","textSearch","response","length","responseLimit","Math","min","i","covidTesting","rating","name","address","formatted_address","lat","geometry","lng","openNow","opening_hours","isOpen","push","searchResults","site_lat","site_lng","temp_lats","testing_site_lats","concat","testing_site_lngs","componentDidMount","navigator","geolocation","getCurrentPosition","position","coords","render","JSON","stringify","key","libraries","maps","result"],"mappings":"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","sourcesContent":["import React,  { Component,useState } from 'react';\nimport GoogleMapReact from 'google-map-react';\nimport './map.css'  // for the map, className=\"google-map\"\nimport { Icon } from '@iconify/react'  // for map pin\nimport locationIcon from '@iconify/icons-mdi/map-marker' // for map pin\nimport PlaceCard from '../components/PlaceCard';\nimport Marker from './Marker';\nimport SimpleMarker from './SimpleMarker';\n\n//import { Geolocation, Geoposition } from '@ionic-native/geolocation';\nimport { Button, Input, Divider, message } from 'antd';\nimport { AnyCnameRecord } from 'dns';\nimport {\n    IonHeader,\n    IonToolbar,\n    IonTitle,\n    IonContent,\n    IonList,\n    IonItem,\n    IonLabel,\n    IonInput,\n    IonButton,\n    IonPage\n  } from \"@ionic/react\";\n\nclass Tab1 extends Component  {\n    constructor(props) {\n        super(props);\n        this.state = {\n            mapsLoaded: false,     \n            latitude:38,\n            longitude:-118,\n            map: {},\n            mapsApi: {},\n            markers: [],\n            searchResults: [],\n            placesService: {},\n            geoCoderService: {},\n            directionService: {},\n            testing_site_lats: [], // array of number\n            testing_site_lngs: [],\n        };\n    }\n    apiHasLoaded = ((map, mapsApi) => {\n        this.setState({\n          mapsLoaded: true,\n          map: map,\n          mapsApi: mapsApi,\n          placesService: new mapsApi.places.PlacesService(map),\n          geoCoderService: new mapsApi.Geocoder(),\n          directionService: new mapsApi.DirectionsService(),\n        });\n    });\n    \n\n    handleSearch = (() => {\n      if (this.state.map === {}){\n        return\n      }\n      console.log(this.state.mapsApi);\n      console.log(this.state.map);\n      console.log(this.state.placesService);\n      console.log(this.state.latitude, this.state.longitude);\n        let {markers, placesService, directionService,mapsApi } = this.state;\n        const filteredResults = [];\n        //if (markers.length === 0){\n        //  console.log(\"add marker and try again\");\n        //  return;\n        //}\n        const markerLatLng = new mapsApi.LatLng(this.state.latitude, this.state.longitude);\n        const placesRequest = {\n              location: markerLatLng,\n              //radius: '3000000', // Cannot be used with rankBy. Pick your poison!\n              type: ['hospital', 'pharmacy','doctor'], // List of types: https://developers.google.com/places/supported_types\n              query: 'covid 19 testing site',\n              rankBy: mapsApi.places.RankBy.DISTANCE,\n          }\n          console.log(placesRequest);\n          placesService.textSearch(placesRequest, ((response) => {\n              console.log(response.length)\n              let responseLimit = Math.min(5, response.length);\n              for (let i = 0; i < responseLimit; i++) {\n                  const covidTesting = response[i];\n                  const { rating, name } = covidTesting;\n                  const address = covidTesting.formatted_address; \n                  const lat = covidTesting.geometry.location.lat();\n                  const lng = covidTesting.geometry.location.lng();\n                  let openNow = false;\n                  if (covidTesting.opening_hours) {\n                      openNow = covidTesting.opening_hours.isOpen(); // e.g true/false\n                  }\n                  //console.log(name,address, openNow);\n                  filteredResults.push({\n                    name,\n                    address,\n                    rating,\n                    lat, \n                    lng,\n                    openNow,\n                  });\n                  this.setState({ searchResults: filteredResults });\n              }\n              console.log(this.state.searchResults);  \n              for(let i=0; i<5; i++){\n                  if (this.state.searchResults[i] != null){\n                    console.log(\"check inside\");\n                    const site_lat = this.state.searchResults[i].lat;\n                    const site_lng = this.state.searchResults[i].lng;\n                    const temp_lats = this.state.testing_site_lats.concat(site_lat);\n                    console.log(\"check temp:\", temp_lats);\n                    this.setState({testing_site_lngs: [1,2]});\n                    }\n              }\n              console.log(\"checkkk  lat:\", this.state.testing_site_lats);\n              //  for(let i=0; i<5; i++){\n              //    if (this.state.searchResults[i] != null){\n              //      const site_lat = this.state.searchResults[i].lat;\n              //      const site_lng = this.state.searchResults[i].lng;\n              //      console.log(\"checkkk \", i+1, \"th site: \", site_lat, site_lng );\n              //      const latlng = {\"lat\": site_lat, \"lng\": site_lng};\n              //      var temp_array = this.testing_site_latlng;\n              //      temp_array.push(latlng);\n              //      this.setState(testing_site_latlng: temp_array);\n              //    } \n              //  }\n\n              // const site_lat = this.state.searchResults[0] ?  this.state.searchResults[0].lat : 37.7313737;\n              // const site_lng = this.state.searchResults[0] ?  this.state.searchResults[0].lng : -122.4125537;\n              // console.log(\"hello trying\")\n              // console.log(\"lat and lng are: \", site_lat, site_lng); \n              \n          }\n          ))\n    });\n    \n    async componentDidMount() {\n      await navigator.geolocation.getCurrentPosition(\n          position => this.setState({ \n              latitude: position.coords.latitude, \n              longitude: position.coords.longitude\n          })\n      )\n  }\n\n\n//    handleClick = () => {\n//        this.componentDidMount();\n//        console.log(\"set longitude:\",this.state.longitude);\n//      }\n      \n\n      //<IonButton color=\"primary\" onClick={this.getLocation}>{this.state.longitude ? `${this.state.latitude} ${this.state.longitude}` : \"Get Location\"}</IonButton>\n      render(){\n\n      //const { constraints, mapsLoaded, singaporeLatLng, markers, searchResults } = this.state;\n      const { markers, geoCoderService,searchResults } = this.state; // Google Maps Services\n      return(\n              <IonPage>\n\n                      {/* \n              <IonHeader>\n                <IonToolbar color=\"primary\">\n                  <IonTitle>Login</IonTitle>\n                </IonToolbar>\n              </IonHeader>\n                        */}\n\n              <IonContent>\n              <div>Current Location: {JSON.stringify(this.state.latitude  )} ,  {JSON.stringify(this.state.longitude )}</div> \n              <div>Initial Location: {JSON.stringify(this.state.latitude )} ,  {JSON.stringify(this.state.longitude)}</div>               \n{/*************** Maps Section ******************************************************************************/}              \n            <div className=\"google-map\">\n            <GoogleMapReact\n              bootstrapURLKeys={{\n                key: \"AIzaSyBj9b-EHxuAAihd8u2HBBqWOSXukFlA3jY\",\n                libraries: ['places', 'directions']\n              }}\n              defaultZoom={15}\n              defaultCenter={{ lat: 38, lng: -118 }}\n              center={{ lat: this.state.latitude, lng: this.state.longitude }}\n              yesIWantToUseGoogleMapApiInternals={true}\n              yesIWantToUseGoogleMapApiInternals\n              onGoogleApiLoaded={({ map, maps }) => this.apiHasLoaded(map, maps)} // \"maps\" is the mapApi. Bad naming but that's their library.\n\n            >\n             <Marker lat={this.state.latitude} lng={this.state.longitude} name=\"My Marker\" color=\"blue\"/>\n             <SimpleMarker lat={this.state.latitude} lng={this.state.longitude} name=\"My Marker\" color=\"blue\"/>\n\n               </GoogleMapReact>\n               </div>\n\n\n{/*************** Search Button ******************************************************************************/}           \n              <IonButton color=\"primary\" onClick={this.handleSearch}> {\"search\"}  </IonButton> \n\n\n{/*************** Result Section ******************************************************************************/}\n            {searchResults.length > 0 ? \n               <>\n\n<section className=\"col-12\">\n<div className=\"d-flex flex-column justify-content-center\">\n\n              <h1 className=\"mb-4 fw-md\">Testing Center Nearby</h1>\n\n                 <div className=\"d-flex flex-wrap\">\n                    {searchResults.map((result, key) => (<PlaceCard info={result} key={key} />))}\n                </div>\n\n</div>                        \n</section>               \n               </>\n               : null}\n\n                </IonContent>\n                </IonPage>\n            );\n      }\n    \n  };\n  \n  \n  \n  \n  export default Tab1;"]},"metadata":{},"sourceType":"module"}